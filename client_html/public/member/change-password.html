<div class="mt-6">
  <h2 class="text-xl font-bold mb-2">Change Password</h2>
  <form id="changePasswordForm" class="space-y-3">
    <input type="password" id="currentPassword" placeholder="Current Password"
           class="w-full px-4 py-2 border rounded-lg"/>
    <input type="password" id="newPassword" placeholder="New Password"
           class="w-full px-4 py-2 border rounded-lg"/>
    <button type="submit" class="w-full bg-red-600 text-white py-2 rounded-lg hover:bg-red-700">
      Change Password
    </button>
  </form>
</div>

<script>
  const changePasswordForm = document.getElementById("changePasswordForm");

  changePasswordForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const currentPassword = document.getElementById("currentPassword").value;
    const newPassword = document.getElementById("newPassword").value;

    if (!currentPassword || !newPassword) return alert("Fill all fields");

    const res = await fetch("http://localhost:4000/member/change-password", {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
        Authorization: "Bearer " + localStorage.getItem("token")
      },
      body: JSON.stringify({ currentPassword, newPassword })
    });

    const data = await res.json();
    if (res.ok) {
      changePasswordForm.reset();
      alert(data.message + " Please login again.");
      localStorage.removeItem("token");
      window.location.href = "/login.html";
    } else {
      alert(data.message || "Failed to change password");
    }

    
  });
</script>
